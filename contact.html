<section id="communicate" class="communicate">
    <div class="communicate-container">
        <div class="communicate-left">
            <h2>צרו קשר</h2>
            <p class="contact-text">
                אני כאן כדי להקשיב ולעזור. אם יש לכם שאלות, בקשות או שאתם מעוניינים לקבוע פגישה,
                אל תהססו ליצור איתי קשר. אני משתדל להשיב לכל פנייה בהקדם האפשרי.
                ניתן לפנות אלי באמצעות הטופס המצורף או דרך פרטי הקשר הנוספים המופיעים באתר.
                אני מצפה לשמוע מכם!
            </p>
            </div>
        <div class="communicate-right">
            <form action="https://api.web3forms.com/submit" method="POST" class="contact-form" id="contactForm">
                <input type="hidden" name="access_key" value="1ada2139-5fca-4a88-8c40-08e4e8633996">
                <div class="form-group">
                    <input type="text" id="name" name="שם מלא" placeholder="שם מלא" required autocomplete="name">
                </div>
                <div class="form-group">
                    <input type="email" id="email" name="מייל" placeholder="מייל" required autocomplete="email">
                </div>
                <div class="form-group">
                    <input type="tel" id="phone" name="טלפון" placeholder="טלפון" required autocomplete="tel">
                </div>
                <div class="form-group">
                    <textarea id="content" name="תוכן הפניה" placeholder="תוכן הפניה" required style="overflow-y: auto;"></textarea>
                </div>
                <button type="submit">שליחה</button>
                <div id="form-message" class="form-message"></div>
            </form>
        </div>
    </div>
</section>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const form = document.getElementById('contactForm');
        const formMessage = document.getElementById('form-message');
        const textarea = document.getElementById('content');

        form.addEventListener('submit', async (event) => {
            event.preventDefault();

            const formData = new FormData(form);

            try {
                const response = await fetch('https://api.web3forms.com/submit', {
                    method: 'POST',
                    body: formData
                });

                if (response.ok) {
                    formMessage.className = 'form-message success';
                    formMessage.textContent = 'הודעה נשלחה בהצלחה! ניצור קשר בהקדם.';
                    form.reset();
                } else {
                    const errorData = await response.json();
                    console.error('שגיאה בשליחת הטופס:', errorData);
                    formMessage.className = 'form-message error';
                    formMessage.textContent = 'אירעה שגיאה בשליחת ההודעה. אנא נסו שוב מאוחר יותר.';
                }
            } catch (error) {
                console.error('שגיאה כללית:', error);
                formMessage.className = 'form-message error';
                formMessage.textContent = 'אירעה שגיאה כללית. אנא נסו שוב מאוחר יותר.';
            }
        });

        // אפשור גדילה אוטומטית של שדה הטקסט
        textarea.addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = (this.scrollHeight) + 'px';
        });
    });
</script>
